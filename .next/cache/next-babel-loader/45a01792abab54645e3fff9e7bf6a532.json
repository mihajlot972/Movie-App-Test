{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _jsxFileName = \"/home/mihajlot/movie-app-test/pages/movies/upcoming-movies.jsx\",\n    _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\nimport React, { useState, useEffect } from 'react';\nimport MovieCard from '../../components/MovieCard/MovieCard';\nimport EmptyItem from '../../components/EmptyItem/EmptyItem';\nimport Layout from '../../components/Layout/Layout';\nimport Head from 'next/head';\nimport LoadMore from '../../components/Shared/LoadMore/LoadMore';\nimport { getUpcomingMovies, searchMovie } from '../../services/movie-service';\nimport Search from '../../components/Shared/Search/Search';\nexport var __N_SSG = true;\nexport default function UpcomingMovies(_ref) {\n  _s();\n\n  var _this = this;\n\n  var upcomingMovies = _ref.upcomingMovies;\n\n  var _useState = useState(2),\n      page = _useState[0],\n      setPage = _useState[1];\n\n  var _useState2 = useState(\"\"),\n      search = _useState2[0],\n      setSearch = _useState2[1];\n\n  var _useState3 = useState(upcomingMovies.results),\n      currentMovies = _useState3[0],\n      setCurrentMovies = _useState3[1];\n\n  var searchTimeout;\n  useEffect(function () {\n    if (search.length <= 1) {\n      setCurrentMovies(upcomingMovies.results);\n    }\n  }, [search]);\n\n  function paginate() {\n    return _paginate.apply(this, arguments);\n  }\n\n  function _paginate() {\n    _paginate = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var paginatedMovies;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return getUpcomingMovies(page);\n\n            case 2:\n              paginatedMovies = _context.sent;\n              setCurrentMovies([].concat(_toConsumableArray(currentMovies), _toConsumableArray(paginatedMovies.results)));\n              setPage(function (page) {\n                return page + 1;\n              });\n\n            case 5:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n    return _paginate.apply(this, arguments);\n  }\n\n  function handleSearch(_x) {\n    return _handleSearch.apply(this, arguments);\n  }\n\n  function _handleSearch() {\n    _handleSearch = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(event) {\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              event.persist();\n              clearTimeout(searchTimeout);\n              searchTimeout = setTimeout( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n                var searchValue, searchedQuery;\n                return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n                  while (1) {\n                    switch (_context2.prev = _context2.next) {\n                      case 0:\n                        searchValue = event.target.value;\n                        setSearch(searchValue);\n\n                        if (!(searchValue.length > 1)) {\n                          _context2.next = 7;\n                          break;\n                        }\n\n                        _context2.next = 5;\n                        return searchMovie(searchValue);\n\n                      case 5:\n                        searchedQuery = _context2.sent;\n\n                        if (searchedQuery.results) {\n                          searchedQuery.results.sort(function (a, b) {\n                            return b.vote_average - a.vote_average;\n                          });\n                          setCurrentMovies(searchedQuery.results);\n                        }\n\n                      case 7:\n                      case \"end\":\n                        return _context2.stop();\n                    }\n                  }\n                }, _callee2);\n              })), 500);\n\n            case 3:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n    return _handleSearch.apply(this, arguments);\n  }\n\n  return __jsx(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 55,\n      columnNumber: 9\n    }\n  }, __jsx(Layout, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 13\n    }\n  }, __jsx(Search, {\n    onChange: handleSearch,\n    placeholder: \"search for movies\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 17\n    }\n  }), __jsx(Head, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 17\n    }\n  }, __jsx(\"title\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 21\n    }\n  }, \"Upcoming Movies\"), __jsx(\"link\", {\n    rel: \"icon\",\n    href: \"/favicon.ico\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 21\n    }\n  })), currentMovies.length > 0 ? __jsx(\"div\", {\n    style: {\n      display: 'flex',\n      flexWrap: 'wrap'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 45\n    }\n  }, currentMovies.map(function (movie) {\n    return __jsx(\"div\", {\n      key: movie.id,\n      className: \"movie-col\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 65,\n        columnNumber: 29\n      }\n    }, __jsx(MovieCard, {\n      id: movie.id,\n      poster_path: movie.poster_path,\n      title: movie.title,\n      overview: movie.overview,\n      release_date: movie.release_date,\n      vote_average: movie.vote_average,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 33\n      }\n    }));\n  })) : __jsx(EmptyItem, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 26\n    }\n  }, \"Sorry, couldn't find any movie regarding this keyword :/\"), __jsx(LoadMore, {\n    paginate: paginate,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 17\n    }\n  })));\n}\n\n_s(UpcomingMovies, \"gYF5oShRVYUMItfHAJsR1myLZaw=\");\n\n_c = UpcomingMovies;\n\nvar _c;\n\n$RefreshReg$(_c, \"UpcomingMovies\");","map":{"version":3,"sources":["/home/mihajlot/movie-app-test/pages/movies/upcoming-movies.jsx"],"names":["React","useState","useEffect","MovieCard","EmptyItem","Layout","Head","LoadMore","getUpcomingMovies","searchMovie","Search","UpcomingMovies","upcomingMovies","page","setPage","search","setSearch","results","currentMovies","setCurrentMovies","searchTimeout","length","paginate","paginatedMovies","handleSearch","event","persist","clearTimeout","setTimeout","searchValue","target","value","searchedQuery","sort","a","b","vote_average","display","flexWrap","map","movie","id","poster_path","title","overview","release_date"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport MovieCard from '../../components/MovieCard/MovieCard';\nimport EmptyItem from '../../components/EmptyItem/EmptyItem';\nimport Layout from '../../components/Layout/Layout';\nimport Head from 'next/head';\nimport LoadMore from '../../components/Shared/LoadMore/LoadMore';\nimport { getUpcomingMovies, searchMovie } from '../../services/movie-service';\nimport Search from '../../components/Shared/Search/Search';\n\nexport async function getStaticProps() {\n    const upcomingMovies = await getUpcomingMovies();\n    return { props: { upcomingMovies } }\n}\n\nexport default function UpcomingMovies({ upcomingMovies }) {\n    const [page, setPage] = useState(2);\n    const [search, setSearch] = useState(\"\");\n    const [currentMovies, setCurrentMovies] = useState(upcomingMovies.results);\n    let searchTimeout;\n\n    useEffect(() => {\n        if (search.length <= 1) {\n            setCurrentMovies(upcomingMovies.results)\n        }\n    }, [search])\n\n    async function paginate() {\n        const paginatedMovies = await getUpcomingMovies(page)\n        setCurrentMovies([...currentMovies, ...paginatedMovies.results])\n        setPage(page => page + 1);\n    }\n\n    async function handleSearch(event) {\n        event.persist();\n\n        clearTimeout(searchTimeout);\n        searchTimeout = setTimeout(async () => {\n            let searchValue = event.target.value;\n            setSearch(searchValue);\n\n            if (searchValue.length > 1) {\n                let searchedQuery = await searchMovie(searchValue);\n                if (searchedQuery.results) {\n                    searchedQuery.results.sort((a, b) => {\n                        return b.vote_average - a.vote_average;\n                    })\n                    setCurrentMovies(searchedQuery.results)\n                }\n            }\n        }, 500);\n    }\n\n\n    return (\n        <div>\n            <Layout>\n                <Search onChange={handleSearch} placeholder=\"search for movies\" />\n                <Head>\n                    <title>Upcoming Movies</title>\n                    <link rel=\"icon\" href=\"/favicon.ico\" />\n                </Head>\n                {currentMovies.length > 0 ? <div style={{ display: 'flex', flexWrap: 'wrap' }}>\n                    {currentMovies.map(movie => {\n                        return (\n                            <div key={movie.id} className=\"movie-col\">\n                                <MovieCard\n                                    id={movie.id}\n                                    poster_path={movie.poster_path}\n                                    title={movie.title}\n                                    overview={movie.overview}\n                                    release_date={movie.release_date}\n                                    vote_average={movie.vote_average}\n                                />\n                            </div>\n                        )\n                    })}\n                </div> : <EmptyItem>Sorry, couldn't find any movie regarding this keyword :/</EmptyItem>}\n                <LoadMore paginate={paginate} />\n            </Layout>\n        </div>\n\n\n    )\n}\n"]},"metadata":{},"sourceType":"module"}