{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _jsxFileName = \"/home/mihajlot/movie-app-test/pages/index.jsx\",\n    _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\nimport React, { useState, useEffect } from 'react';\nimport Head from 'next/head';\nimport { getPopularMovies, searchMovie } from '../services/movie-service';\nimport MovieCard from '../components/MovieCard/MovieCard';\nimport Layout from '../components/Layout/Layout';\nimport LoadMore from '../components/Shared/LoadMore/LoadMore';\nimport Search from '../components/Shared/Search/Search';\nimport EmptyItem from '../components/EmptyItem/EmptyItem';\nexport var __N_SSG = true;\nexport default function Home(_ref) {\n  _s();\n\n  var _this = this;\n\n  var popularMovies = _ref.popularMovies;\n\n  var _useState = useState(2),\n      page = _useState[0],\n      setPage = _useState[1];\n\n  var _useState2 = useState(popularMovies.results),\n      currentMovies = _useState2[0],\n      setCurrentMovies = _useState2[1];\n\n  var _useState3 = useState(\"\"),\n      search = _useState3[0],\n      setSearch = _useState3[1];\n\n  var searchTimeout;\n  useEffect(function () {\n    if (search.length <= 1) {\n      setCurrentMovies(popularMovies.results);\n    }\n  }, [search]);\n\n  function paginate() {\n    return _paginate.apply(this, arguments);\n  }\n\n  function _paginate() {\n    _paginate = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var paginatedMovies;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return getPopularMovies(page);\n\n            case 2:\n              paginatedMovies = _context.sent;\n              console.log(paginatedMovies.results);\n              setCurrentMovies([].concat(_toConsumableArray(currentMovies), _toConsumableArray(paginatedMovies.results)));\n              setPage(function (page) {\n                return page + 1;\n              });\n\n            case 6:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n    return _paginate.apply(this, arguments);\n  }\n\n  function handleSearch(_x) {\n    return _handleSearch.apply(this, arguments);\n  }\n\n  function _handleSearch() {\n    _handleSearch = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(event) {\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              event.persist(); // Adding timeout for performance reasons\n\n              clearTimeout(searchTimeout);\n              searchTimeout = setTimeout( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n                var searchValue, searchedQuery;\n                return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n                  while (1) {\n                    switch (_context2.prev = _context2.next) {\n                      case 0:\n                        searchValue = event.target.value;\n                        setSearch(searchValue);\n\n                        if (!(searchValue.length > 1)) {\n                          _context2.next = 7;\n                          break;\n                        }\n\n                        _context2.next = 5;\n                        return searchMovie(searchValue);\n\n                      case 5:\n                        searchedQuery = _context2.sent;\n\n                        if (searchedQuery.results) {\n                          searchedQuery.results.sort(function (a, b) {\n                            return b.vote_average - a.vote_average;\n                          });\n                          setCurrentMovies(searchedQuery.results);\n                        }\n\n                      case 7:\n                      case \"end\":\n                        return _context2.stop();\n                    }\n                  }\n                }, _callee2);\n              })), 500);\n\n            case 3:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n    return _handleSearch.apply(this, arguments);\n  }\n\n  return __jsx(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 5\n    }\n  }, __jsx(Layout, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 7\n    }\n  }, __jsx(Search, {\n    placeholder: \"search for movies\",\n    onChange: function onChange(event) {\n      return handleSearch(event);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 9\n    }\n  }), __jsx(Head, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 9\n    }\n  }, __jsx(\"title\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 11\n    }\n  }, \"Movie App\"), __jsx(\"link\", {\n    rel: \"icon\",\n    href: \"/favicon.ico\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 11\n    }\n  })), __jsx(\"main\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 9\n    }\n  }, currentMovies.length > 0 ? __jsx(\"div\", {\n    style: {\n      display: 'flex',\n      flexWrap: 'wrap'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 39\n    }\n  }, currentMovies.map(function (movie) {\n    return __jsx(\"div\", {\n      key: movie.id,\n      className: \"movie-col\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 17\n      }\n    }, __jsx(MovieCard, {\n      id: movie.id,\n      poster_path: movie.poster_path,\n      title: movie.title,\n      overview: movie.overview,\n      release_date: movie.release_date,\n      vote_average: movie.vote_average,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 19\n      }\n    }));\n  })) : __jsx(EmptyItem, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 20\n    }\n  }, \"Sorry, couldn't find any movie regarding this keyword :/\"), search.length === 0 ? __jsx(LoadMore, {\n    paginate: paginate,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 34\n    }\n  }) : null)));\n}\n\n_s(Home, \"SDOI6O/d9ydH/uM6KUxisld40II=\");\n\n_c = Home;\n\nvar _c;\n\n$RefreshReg$(_c, \"Home\");","map":{"version":3,"sources":["/home/mihajlot/movie-app-test/pages/index.jsx"],"names":["React","useState","useEffect","Head","getPopularMovies","searchMovie","MovieCard","Layout","LoadMore","Search","EmptyItem","Home","popularMovies","page","setPage","results","currentMovies","setCurrentMovies","search","setSearch","searchTimeout","length","paginate","paginatedMovies","console","log","handleSearch","event","persist","clearTimeout","setTimeout","searchValue","target","value","searchedQuery","sort","a","b","vote_average","display","flexWrap","map","movie","id","poster_path","title","overview","release_date"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport Head from 'next/head';\nimport { getPopularMovies, searchMovie } from '../services/movie-service';\nimport MovieCard from '../components/MovieCard/MovieCard';\nimport Layout from '../components/Layout/Layout';\nimport LoadMore from '../components/Shared/LoadMore/LoadMore';\nimport Search from '../components/Shared/Search/Search';\nimport EmptyItem from '../components/EmptyItem/EmptyItem';\n\n\nexport async function getStaticProps() {\n  const popularMovies = await getPopularMovies();\n  return { props: { popularMovies } }\n}\n\nexport default function Home({ popularMovies }) {\n  const [page, setPage] = useState(2);\n  const [currentMovies, setCurrentMovies] = useState(popularMovies.results);\n  const [search, setSearch] = useState(\"\");\n  let searchTimeout;\n\n  useEffect(() => {\n    if (search.length <= 1) {\n      setCurrentMovies(popularMovies.results)\n    }\n  }, [search])\n\n  async function paginate() {\n    const paginatedMovies = await getPopularMovies(page);\n    console.log(paginatedMovies.results);\n    setCurrentMovies([...currentMovies, ...paginatedMovies.results]);\n    setPage(page => page + 1);\n  }\n\n  async function handleSearch(event) {\n    event.persist();\n\n    // Adding timeout for performance reasons\n    clearTimeout(searchTimeout);\n    searchTimeout = setTimeout(async () => {\n      let searchValue = event.target.value;\n      setSearch(searchValue);\n\n      if (searchValue.length > 1) {\n        let searchedQuery = await searchMovie(searchValue);\n        if (searchedQuery.results) {\n          searchedQuery.results.sort((a, b) => {\n            return b.vote_average - a.vote_average;\n          })\n          setCurrentMovies(searchedQuery.results)\n        }\n      }\n    }, 500);\n  }\n\n\n  return (\n    <div>\n      <Layout>\n        <Search placeholder=\"search for movies\" onChange={(event) => handleSearch(event)} />\n        <Head>\n          <title>Movie App</title>\n          <link rel=\"icon\" href=\"/favicon.ico\" />\n        </Head>\n\n        <main>\n          {currentMovies.length > 0 ? <div style={{ display: 'flex', flexWrap: 'wrap' }}>\n            {currentMovies.map(movie => {\n              return (\n                <div key={movie.id} className=\"movie-col\">\n                  <MovieCard\n                    id={movie.id}\n                    poster_path={movie.poster_path}\n                    title={movie.title}\n                    overview={movie.overview}\n                    release_date={movie.release_date}\n                    vote_average={movie.vote_average}\n                  />\n                </div>\n              )\n            })}\n          </div> : <EmptyItem>Sorry, couldn't find any movie regarding this keyword :/</EmptyItem>}\n          {search.length === 0 ? <LoadMore paginate={paginate} /> : null}\n        </main>\n      </Layout>\n    </div>\n  )\n}\n\n"]},"metadata":{},"sourceType":"module"}