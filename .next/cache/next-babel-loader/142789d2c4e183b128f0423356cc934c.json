{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _jsxFileName = \"/home/mihajlot/movie-app-test/components/AddToFavorites/AddToFavorites.jsx\",\n    _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\nimport React, { useState } from 'react';\nimport { createRequestToken, createAccessToken } from '../../services/auth-service';\nimport { markFavoriteMovie } from '../../services/movie-service';\nimport styles from './AddToFavorites.module.scss';\nimport { HeartOutlined } from '@ant-design/icons';\nimport ReactTooltip from \"react-tooltip\";\nimport Modal from '../Modal/Modal';\nimport Button from '../Shared/Button/Button';\nimport { stubFalse, remove } from 'lodash';\n\nfunction AddToFavorites(_ref) {\n  _s();\n\n  var movieId = _ref.movieId;\n\n  var _useState = useState(false),\n      isModal = _useState[0],\n      setModal = _useState[1];\n\n  var _useState2 = useState(\"\"),\n      requestURL = _useState2[0],\n      setRequestURL = _useState2[1];\n\n  var _useState3 = useState(\"\"),\n      success = _useState3[0],\n      setSuccess = _useState3[1];\n\n  var _useState4 = useState(false),\n      deleteSuccess = _useState4[0],\n      setDeleteSuccess = _useState4[1];\n\n  function addFavorite() {\n    return _addFavorite.apply(this, arguments);\n  }\n\n  function _addFavorite() {\n    _addFavorite = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var access_token, account_id, session_id, requestToken, markFavorite;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              access_token = localStorage.getItem(\"access_token\");\n              account_id = localStorage.getItem(\"account_id\");\n              session_id = localStorage.getItem(\"session_id\");\n\n              if (access_token) {\n                _context.next = 12;\n                break;\n              }\n\n              setModal(true);\n              _context.next = 7;\n              return createRequestToken();\n\n            case 7:\n              requestToken = _context.sent;\n              localStorage.setItem('request_token', requestToken.request_token);\n              setRequestURL(\"https://www.themoviedb.org/auth/access?request_token=\".concat(requestToken.request_token));\n              _context.next = 17;\n              break;\n\n            case 12:\n              _context.next = 14;\n              return markFavoriteMovie(movieId, account_id, session_id);\n\n            case 14:\n              markFavorite = _context.sent;\n\n              if (markFavorite.status_message === \"Success.\") {\n                setSuccess(\"Movie added to your favorites list!\");\n              }\n\n              if (markFavorite.status_message === \"The item/record was updated successfully.\") {\n                setSuccess(\"This movie is in your favorite list\");\n              }\n\n            case 17:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n    return _addFavorite.apply(this, arguments);\n  }\n\n  function removeFavorite() {\n    return _removeFavorite.apply(this, arguments);\n  }\n\n  function _removeFavorite() {\n    _removeFavorite = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      var account_id, session_id, markFavorite;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              account_id = localStorage.getItem(\"account_id\");\n              session_id = localStorage.getItem(\"session_id\");\n              _context2.next = 4;\n              return markFavoriteMovie(movieId, account_id, session_id, false);\n\n            case 4:\n              markFavorite = _context2.sent;\n\n              if (markFavorite.status_message === \"The item/record was deleted successfully.\") {\n                setSuccess(\"Movie removed from favorites\");\n                setDeleteSuccess(true);\n              }\n\n            case 6:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n    return _removeFavorite.apply(this, arguments);\n  }\n\n  return __jsx(\"div\", {\n    className: styles.addToFavoritesWrapper,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 49,\n      columnNumber: 9\n    }\n  }, __jsx(Modal, {\n    isVisible: isModal,\n    title: \"We need to authorize you first\",\n    content: __jsx(\"a\", {\n      href: requestURL,\n      target: \"_blank\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 53,\n        columnNumber: 26\n      }\n    }, \"Click here to approve account usage\"),\n    footer: __jsx(Button, {\n      onClick: function onClick() {\n        return setModal(stubFalse);\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 54,\n        columnNumber: 25\n      }\n    }, \"Not now\"),\n    onClose: function onClose() {\n      return setModal(false);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 50,\n      columnNumber: 13\n    }\n  }), __jsx(\"div\", {\n    className: styles.addToFavorites,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 13\n    }\n  }, success.length > 0 ? __jsx(\"div\", {\n    className: styles.heartPressed,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 17\n    }\n  }, __jsx(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 21\n    }\n  }, success), !deleteSuccess ? __jsx(\"p\", {\n    className: styles.removeFavorite,\n    onClick: removeFavorite,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 21\n    }\n  }, \"Remove it?\") : null) : __jsx(HeartOutlined, {\n    onClick: addFavorite,\n    \"data-tip\": \"Love this movie? Add it to favorites!\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 17\n    }\n  }), __jsx(ReactTooltip, {\n    effect: \"solid\",\n    uuid: \"mytt\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 17\n    }\n  })));\n}\n\n_s(AddToFavorites, \"2Bwg9iQN9lj/U485h+9lrZ/Xtas=\");\n\n_c = AddToFavorites;\nexport default AddToFavorites;\n\nvar _c;\n\n$RefreshReg$(_c, \"AddToFavorites\");","map":{"version":3,"sources":["/home/mihajlot/movie-app-test/components/AddToFavorites/AddToFavorites.jsx"],"names":["React","useState","createRequestToken","createAccessToken","markFavoriteMovie","styles","HeartOutlined","ReactTooltip","Modal","Button","stubFalse","remove","AddToFavorites","movieId","isModal","setModal","requestURL","setRequestURL","success","setSuccess","deleteSuccess","setDeleteSuccess","addFavorite","access_token","localStorage","getItem","account_id","session_id","requestToken","setItem","request_token","markFavorite","status_message","removeFavorite","addToFavoritesWrapper","addToFavorites","length","heartPressed"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\nimport { createRequestToken, createAccessToken } from '../../services/auth-service';\nimport { markFavoriteMovie } from '../../services/movie-service';\nimport styles from './AddToFavorites.module.scss';\nimport { HeartOutlined } from '@ant-design/icons';\nimport ReactTooltip from \"react-tooltip\";\nimport Modal from '../Modal/Modal';\nimport Button from '../Shared/Button/Button';\nimport { stubFalse, remove } from 'lodash';\n\nfunction AddToFavorites({ movieId }) {\n    const [isModal, setModal] = useState(false);\n    const [requestURL, setRequestURL] = useState(\"\");\n    const [success, setSuccess] = useState(\"\");\n    const [deleteSuccess, setDeleteSuccess] = useState(false);\n\n    async function addFavorite() {\n        let access_token = localStorage.getItem(\"access_token\");\n        let account_id = localStorage.getItem(\"account_id\");\n        let session_id = localStorage.getItem(\"session_id\");\n\n        if (!access_token) {\n            setModal(true)\n            let requestToken = await createRequestToken();\n            localStorage.setItem('request_token', requestToken.request_token);\n            setRequestURL(`https://www.themoviedb.org/auth/access?request_token=${requestToken.request_token}`)\n        } else {\n            let markFavorite = await markFavoriteMovie(movieId, account_id, session_id);\n            if (markFavorite.status_message === \"Success.\") {\n                setSuccess(\"Movie added to your favorites list!\");\n            }\n            if (markFavorite.status_message === \"The item/record was updated successfully.\") {\n                setSuccess(\"This movie is in your favorite list\")\n            }\n        }\n    }\n\n    async function removeFavorite() {\n        let account_id = localStorage.getItem(\"account_id\");\n        let session_id = localStorage.getItem(\"session_id\");\n        let markFavorite = await markFavoriteMovie(movieId, account_id, session_id, false);\n        if (markFavorite.status_message === \"The item/record was deleted successfully.\") {\n            setSuccess(\"Movie removed from favorites\")\n            setDeleteSuccess(true)\n        }\n    }\n\n    return (\n        <div className={styles.addToFavoritesWrapper}>\n            <Modal\n                isVisible={isModal}\n                title=\"We need to authorize you first\"\n                content={<a href={requestURL} target='_blank'>Click here to approve account usage</a>}\n                footer={<Button onClick={() => setModal(stubFalse)}>Not now</Button>}\n                onClose={() => setModal(false)}\n            />\n\n            <div className={styles.addToFavorites}>\n\n                {success.length > 0 ? \n                <div className={styles.heartPressed}>\n                    <p>{success}</p>\n                    {\n                    !deleteSuccess ? \n                    <p className={styles.removeFavorite} onClick={removeFavorite}>Remove it?</p> \n                    : null\n                    }\n                </div> \n                : \n                <HeartOutlined onClick={addFavorite} data-tip=\"Love this movie? Add it to favorites!\" />\n                }\n                <ReactTooltip effect=\"solid\" uuid=\"mytt\" />\n            </div>\n        </div>\n    )\n}\n\n\nexport default AddToFavorites;"]},"metadata":{},"sourceType":"module"}